{% extends 'base.html.twig' %}

{% block title %}List all users{% endblock %}
{% block meta %}List all users{% endblock %}

{% block body %}



   <h2>search</h2>
   {{ form_start(formUserSearch, {'method': 'POST'}) }}
   {{ form_errors(formUserSearch)}}

   {{ form_row(formUserSearch.username, {
    'attr': {'minlength': 3}
    }) }}

   <button type="submit">Search</button>
   {{ form_end(formUserSearch) }}



   <form method="GET" action="{{ path('list_users') }}">
    <label for="role">Choose a role:</label>
    <select id="role" name="role">
            <option value="" disabled selected>Choose a role</option>
            <option value="ROLE_ADMIN">admin</option>
            <option value="ROLE_ARTIST">artist</option>
            <option value="ROLE_SUPERVISOR">supervisor</option>
            {# <option value=user>USER</option> #}
    </select>    
    <button type="submit">Filter</button>
    </form>

    <form method="GET" action="{{ path('list_users') }}">
    <label for="sortBy">Sort by:</label>
    <select id="sortBy" name="sortBy">
        <option value="" disabled selected>Choose a filter</option>
        <option value="username_asc">Username (A-Z)</option>
        <option value="username_desc">Username (Z-A)</option>
        <option value="createdAt_asc">Date of Registration (Oldest first)</option>
        <option value="createdAt_desc">Date of Registration (Newest first)</option>
    </select>
    <button type="submit">Filter</button>
    </form>


   {# filter 
   affichage par ordre alphabétique ou du plus ancie, ou plus récent #}

   {% if searchResults %}
        <h2>Search results</h2>
    {% else %}
        <h2>All users</h2>
    {% endif %}


   <ul>
       {% for user in users %}
       <li>
            <p>  Username : <a href="{{ path('detail_user_admin', {slug : user.slug}) }}">{{user}}</a></p>
            <p>Email: {{user.Email}}</p>
            <p>Registration date: {{user.registrationDate|formatDate}}</p>
            {% if user.getSimpleRoles|length > 0 %}
            <!-- Afficher la ligne de rôle uniquement si l'utilisateur est autre qu'un simple user -->
            <p>Role: {{ user.getSimpleRoles|join(', ')}}</p>
            {% endif %}

            {% if 'artist' in user.getSimpleRoles %}
                <p class="artist-icon"><i class="fas fa-paint-brush"></i> Artist</p>
            {% endif %}

            {% if 'admin' in user.getSimpleRoles %}
                <p class="artist-icon"><i class="fa-solid fa-gear"></i> Admin</p>
            {% endif %}

            {% if 'supervisor' in user.getSimpleRoles %}
                <p class="artist-icon"><i class="fa-solid fa-user-tie"></i> Supervisor</p>
            {% endif %}

            <hr>
           
       </li>
       {% endfor %}

   </ul>

   <div id="search-results"></div>

{% endblock %}
